---
title: "Spring 2021 Waste Audit"
author: "Hailey Ross, Shreya Joshi, Danny Wu, Chaya Brennan Agarwal"
subtitle: Duke Student Government Services and Sustainability Committee
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, echo = FALSE}
knitr::opts_chunk$set(echo = FALSE, comment = NA, 
                      message = FALSE, warning = FALSE,
                      fig.height = 6, fig.width = 9, fig.align = "center")
```

```{r packages}
library(tidyverse)
library(infer)
library(car)
library(stringr)
library(robotstxt)
library(rvest)
library(httr)
library(tinytex)
library(sf)
```

```{r upload-and-clean-data}
waste_audit <- read.csv(file = 'waste_audit_datasheet.csv') %>% 
  select(-c(X, X26)) %>% 
  slice(1:22)
```

# Introduction

hypothesis

goal:

- judge importance of waste education on campus
- identify ways that we could educate students on waste more successfully
- identify ways that the university could improve waste practices
- quantify the amount of compost produced
- calculate how much composting could be diverted from landfills
- judge the value of the waste audit; should it be recreated?
- how did COVID impact waste on campus? how did COVID impact waste numbers on campus?

- percent of students living on campus
- how many students living on campus; can we make an estimate as to how much waste the average meal produces?
- global trash statistics
- sustainable dining goals in implementing compostables during COVID
- composting surveys
- this comes at a time after (or right before???) the university placed composting awareness posters on the doors of WU

# Methodology

## Content Comparisons
- average weight of a piece of trash, composting, and recycling item
```{r average-piece-weight}
waste_audit %>% 
  summarize(total_trash_pieces = sum(pieces_trash),
            total_recycle_pieces = sum(pieces_recycle),
            total_compost_pieces = sum(pieces_compost),
            total_trash_weight = sum(weight_trash), 
            total_recycle_weight = sum(weight_recycle),
            total_compost_weight = sum(weight_compost)) %>% 
  summarize(average_trash_weight = total_trash_weight / total_trash_pieces,
            average_recycle_weight = total_recycle_weight / total_recycle_pieces,
            average_compost_weight = total_compost_weight / total_compost_pieces)
```

- comparative starting volume of pieces/weight between trash and recycle streams
```{r starting-volumes}
waste_audit %>% 
  mutate(original_weight = weight_trash + weight_recycle + weight_compost,
         original_pieces = pieces_trash + pieces_recycle + pieces_compost) %>% 
  group_by(original_stream) %>% 
  summarize(avg_starting_weight = mean(original_weight),
            avg_starting_pieces = mean(original_pieces))
```

```{r bar-plot-original-stream-piece-comparison}
data <- waste_audit %>% 
  group_by(original_stream) %>% 
  summarize(total_trash = sum(pieces_trash),
            total_recycle = sum(pieces_recycle),
            total_compost = sum(pieces_compost)) %>% 
  select(total_trash, total_recycle, total_compost)

data <- as.matrix(data)

colnames(data) <- c("trash", "recycle", "compost")

rownames(data) <- c("Recycle", "Trash")

color <- c("black", "#3265ab", "#2ca816")

barplot(t(data), beside = FALSE, col = color, ylim = c(0, 2500),
        main = "Missorted Waste", xlab = "Original Stream Designation", ylab = "Total Pieces")
  legend("topleft", colnames(data), pch = 15, col = color, horiz = T, bty = "n")
```

source: https://stackoverflow.com/questions/61506408/grouped-barchart-in-r-with-4-variables

## Quantifying Missorted Waste

```{r bar-plot-original-stream-percent}
makeup <- waste_audit %>% 
  group_by(original_stream) %>% 
  summarize(average_trash = mean(prop_pieces_trash),
            average_recycle = mean(prop_pieces_recycle),
            average_compost = mean(prop_pieces_compost)) %>% 
  select(average_trash, average_recycle, average_compost)

makeup <- as.matrix(makeup)

colnames(makeup) <- c("trash", "recycle", "compost")

rownames(makeup) <- c("Recycle", "Trash")

color <- c("black", "#3265ab", "#2ca816")

barplot(t(makeup), beside = FALSE, col = color, ylim = c(0, 1.1),
        main = "Missorted Waste", xlab = "Original Stream Designation", ylab = "Percent")
legend("topleft", colnames(makeup), pch = 15, col = color, horiz = T, bty = "n")
```

- percent of trash that is missorted
    
```{r missorted-trash}
pie_trash <- waste_audit %>% 
  mutate(missorted = pieces_recycle + pieces_compost) %>% 
  group_by(original_stream) %>% 
  summarize(sorted = sum(pieces_trash),
            missorted = sum(missorted)) %>% 
  slice(2)
pie_trash

slices <- c(555, 1639)
lbls <- c("sorted", "missorted")

percent <- slices / sum(slices) * 100

percent

pct <- round(percent)
lbls <- paste(lbls, pct)
lbls <-paste(lbls, "%", sep = " ")
pie(slices, labels = lbls, col = c("#2ca816", "#cc2900"), main = "Missorted Trash")
```

source: https://www.statmethods.net/graphs/pie.html

- percent of recycling that is missorted
    
```{r missorted-recycle}
pie_recycle <- waste_audit %>% 
  mutate(missorted = pieces_trash + pieces_compost) %>% 
  group_by(original_stream) %>% 
  summarize(sorted = sum(pieces_recycle),
            missorted = sum(missorted)) %>% 
  slice(1)
pie_recycle

slices <- c(174, 489)
lbls <- c("sorted", "missorted")

percent <- slices / sum(slices) * 100

percent

pct <- round(percent)
lbls <- paste(lbls, pct)
lbls <-paste(lbls, "%", sep = " ")
pie(slices, labels = lbls, col = c("#2ca816", "#cc2900"), main = "Missorted Recycle")
```

## Campus Compost
- percent of trash and recycling that could be compost
    
```{r compost-in-trash}
compostable_trash <- waste_audit %>% 
  mutate(noncompostable = pieces_recycle + pieces_trash) %>% 
  group_by(original_stream) %>% 
  summarize(compostable = sum(pieces_compost),
            noncompostable = sum(noncompostable)) %>% 
  slice(2)
compostable_trash

slices <- c(1274, 920)
lbls <- c("compostable", "noncompostable")

percent <- slices / sum(slices) * 100

percent

pct <- round(percent)
lbls <- paste(lbls, pct)
lbls <-paste(lbls, "%", sep = " ")
pie(slices, labels = lbls, col = c("#2ca816", "black"), main = "Percent of Trash that is Compostable")
```
    
```{r compost-in-recycling}
compostable_recycle <- waste_audit %>% 
  mutate(noncompostable = pieces_recycle + pieces_trash) %>% 
  group_by(original_stream) %>% 
  summarize(compostable = sum(pieces_compost),
            noncompostable = sum(noncompostable)) %>% 
  slice(1)
compostable_recycle

slices <- c(320, 343)
lbls <- c("compostable", "noncompostable")

percent <- slices / sum(slices) * 100

percent

pct <- round(percent)
lbls <- paste(lbls, pct)
lbls <-paste(lbls, "%", sep = " ")
pie(slices, labels = lbls, col = c("#2ca816", "black"), main = "Percent of Recycling that is Compostable")
```

- volume of compostables
    bar graph, value
    
```{r compost-volume-values}
volume_bar <- waste_audit %>% 
  summarize(total_pieces_compost = sum(pieces_compost),
            total_weight_compost = sum(weight_compost),
            total_pieces_audited = sum(total_piece_volume),
            total_weight_audited = sum(total_can_weight),
            perc_pieces_compost = total_pieces_compost / total_pieces_audited * 100,
            perc_weight_compost = total_weight_compost / total_weight_audited * 100)

makeup <- as.matrix(volume_bar)

volume_bar <- volume_bar %>% 
  select(perc_pieces_compost, perc_weight_compost)

colnames(volume_bar) <- c("Pieces", "Weight (lbs)")

color <- c("#2ca816", "#8cd9b3")

barplot(t(volume_bar), beside = TRUE, col = color, ylim = c(0, 100),
        main = "Percent Total Compostable", xlab = "Method of Quantifying Waste", ylab = "Percent")
legend("topleft", colnames(volume_bar), pch = 15, col = color, horiz = T, bty = "n")
```

## Differences in Location
-difference between big belly compactors and blue bins (is this because multiple streams are offered through Big Belly Compactors?)
    bar graphs, box plots
-location of the can
    spatial data (https://geocompr.robinlovelace.net/spatial-class.html)

## Sample Size and Confidence
bootstrap sample
bootstrap distribution

null hypothesis and alternative hypothesis
- sample size; can this waste audits data conclusively say anything about campus, or can it merely be used to suggest the need for a more extensive audit? is the sample size representative?
    confidence intervals?
    p-value (notes 15)
    
```{r}
set.seed(405)
```

$$\hat{p} = 0.5$$
$$z^* = 1.96$$
We will use the following margin of error expression to calculate the margin of
error:
$$\pm z^* \times \sqrt{\frac{\hat{p}(1-\hat{p})}{n}} = MOE$$
$$1.96 \times \sqrt{\frac{0.5(1-0.5)}{22}} \le 0.208937$$
Margin of Error (MOE): 0.208937 or 20.8937%

# Results

## Content Comparisons

## Quantifying Missorted Waste

## Campus Compost

## Differences in Location

## Sample Size and Confidence

# Discussion

- error: human error in sorting
- error: some contamination spreads (e.g. containers filled with liquid)
- discuss time of day and year that the data was collected
- note: this does not account for all waste; waste disposed of in dorms, WU conveyor belt, BC, library, quad trash bins, gym (Red Mango), East Campus (Marketplace, dorms)
- semi-random sampling (all recycling bins chosen, which dictated our choices in picking from the trash bins)

# Call to Action



# Cited References

1. 